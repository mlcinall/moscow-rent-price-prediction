# О проекте

Этот проект посвящён оценке стоимости аренды недвижимости в Москве на основе данных с CIAN. Цель — построить полный пайплайн от сбора данных до финальной модели, включающий очистку, обогащение признаков, эксперименты с моделями и оценку на тестовой выборке.

---

## Ключевые цифры

- Объём датасета: ~16 000 объявлений (сбалансировано по ценовым сегментам)
- Финальная модель: `CatBoostRegressor` с целевой переменной `log1p(price)` и гиперпараметрами, подобранными через Optuna
- Метрики на тесте:
  - **MAE:** 21 312.2 ₽
  - **R²:** 0.8911
  - **MAPE:** 16.31 %

**Вывод:** модель объясняет почти 90 % дисперсии и даёт среднюю ошибку около 21 000 ₽. Подходит для массовых оценок, но не гарантирует точность для уникальных или аномальных объектов.

---

## Подробности реализации

### Сбор данных
Данные собраны с помощью библиотеки `cianparser`.
Для балансировки выборки сбор проводился по ценовым диапазонам:
- До 100 000 ₽ — ~60%
- 100–200 000 ₽ — ~25%
- Свыше 200 000 ₽ — ~15%

Такой подход позволяет избежать переобучения на массовом сегменте и обеспечивает репрезентативность по всем ценовым группам.

---

### Очистка и геокодирование
- Удалены записи без адреса.
- Адреса нормализованы.
- Геокодинг: сначала по дому, затем — по улице (с кешированием).
- Удалены объекты за пределами Москвы.

---

### Обогащение признаков
На основе координат и Open Steet Map добавлены:
- Расстояние до центра и до метро.
- Количество парков, школ, магазинов, аптек, клиник в радиусе 1 км.

Артефакты (кеши, KD-деревья) сохранены для быстрого инференса.

---

### EDA и подготовка
- Анализ распределений и корреляций
- Удаление выбросов (например, расстояние до метро > 40 км)

---

### Моделирование  
- Модель: `CatBoostRegressor` с обучением на GPU  
- Целевая переменная: `log1p(price_per_month)` — для стабилизации распределения  

**Эволюция ключевых метрик (валидация):**  
- Начальный бейзлайн (без гео и инфраструктуры): **R² = 0.846**, **MAPE = 18.81%**  
- После добавления координат и расстояний: **R² → 0.866**, **MAPE → 17.81%**  
- После включения инфраструктуры и очистки от выбросов: **R² → 0.884**  
- С логарифмированием и подбором гиперпараметров: **R² = 0.90**, **MAPE = 15.28%**

**Финальная модель на тесте:**  
- **R²: 0.8911** — высокая доля объяснённой дисперсии  
- **MAPE: 16.31%** — стабильная относительная ошибка  

Целевые метрики — **R²** и **MAPE** — продемонстрировали устойчивый рост на каждом этапе улучшения признаков и настройки модели.

---

## Ограничения:

- Модель показывает наилучшее качество в **массовом сегменте** (до ~200 000 ₽). В **элитном сегменте** предсказания менее стабильны из-за меньшего числа аналогов и высокой дисперсии цен.
- **Временная динамика** (сезонность, инфляция, изменения в спросе) не учитывается — модель требует регулярного переобучения на свежих данных для поддержания актуальности.

---

## Пространство для улучшений:

### 1. Использование фотографий (Computer Vision)
— Извлечение визуальных признаков (состояние ремонта, меблировка, планировка) с помощью CNN или предобученных моделей (например, ResNet, CLIP).  
— Полученные эмбеддинги можно добавить как векторные признаки в табличную модель.  
— Это повысит точность, особенно в сегментах, где цену сильно влияет качество интерьера.

### 2. Ограничение цен при парсинге (до 200 000 ₽)
— Около 95% арендаторов ищут жильё в этом диапазоне.  
— Включение редких дорогих объявлений (10% выборки) искажает распределение, смещает средние и увеличивает ошибку в массовом сегменте.  
— Ограничение парсинга сверху на 200 000 ₽ позволит сместить фокус на основную ЦА и повысить точность для целевой аудитории.

